- content_for :page_title_prefix do
  #{@vacancy.job_title} â€” #{@vacancy.school_name}

- content_for :page_description do
  = strip_tags(@vacancy.job_description)

.vacancy.govuk-grid-row
  - if @vacancy.expired?
    .govuk-grid-column-full
      .banner-warning
        = t('jobs.expired')

  .govuk-grid-column-one-third
    %h1.govuk-heading-l
      = @vacancy.job_title
      %span.govuk-caption-l
        = @vacancy.location

    - if (@vacancy.application_link.present? && params[:apply_button] == 'top')
      %aside.vacancy--metadata
        = link_to t('jobs.apply'), new_job_interest_path(@vacancy.id), target: '_blank', class: 'govuk-button vacancy-apply-link', 'aria-label': t('jobs.aria_labels.apply_link')

    %h2.govuk-heading-m
      = t('schools.about')
      = @vacancy.school.name
    %p= @vacancy.school.description

    = render partial: 'school_details'

    - if @vacancy.school.geolocation
      #map_zoom{style: 'height: 200px; margin-bottom: 20px;'}
      = render partial: '/vacancies/school', formats: [:js], locals: { name: @vacancy.school.name,
                                                            lat: @vacancy.school_geolocation.x,
                                                            lng: @vacancy.school_geolocation.y }

      %script{async: true, defer: true, src: "https://maps.googleapis.com/maps/api/js?key=#{ENV['GOOGLE_MAPS_API_KEY']}&callback=initMap" }

    %h2.mt1.govuk-heading-m= t('jobs.key_info')

    %dl.app-check-your-answers.app-check-your-answers--short
      .app-check-your-answers__contents
        %dt.app-check-your-answers__question= t('jobs.salary')
        %dd.app-check-your-answers__answer= @vacancy.salary_range
      - if @vacancy.working_patterns?
        .app-check-your-answers__contents
          %dt.app-check-your-answers__question= t('jobs.working_patterns')
          %dd.app-check-your-answers__answer= @vacancy.working_patterns
          - if @vacancy.flexible_working?
            %dd.app-check-your-answers__answer= @vacancy.flexible_working
      - if @vacancy.weekly_hours?
        .app-check-your-answers__contents
          %dt.app-check-your-answers__question= t('jobs.weekly_hours')
          %dd.app-check-your-answers__answer= @vacancy.weekly_hours
      - if @vacancy.newly_qualified_teacher?
        .app-check-your-answers__contents
          %dt.app-check-your-answers__question= t('jobs.newly_qualified_teacher')
          %dd.app-check-your-answers__answer= @vacancy.newly_qualified_teacher
      - if @vacancy.starts_on.present?
        .app-check-your-answers__contents
          %dt.app-check-your-answers__question= t('jobs.starts_on')
          %dd.app-check-your-answers__answer= format_date(@vacancy.starts_on)
      - if @vacancy.ends_on.present?
        .app-check-your-answers__contents
          %dt.app-check-your-answers__question= t('jobs.ends_on')
          %dd.app-check-your-answers__answer= format_date(@vacancy.ends_on)
      .app-check-your-answers__contents
        %dt.app-check-your-answers__question= t('jobs.publish_on')
        %dd.app-check-your-answers__answer= format_date(@vacancy.publish_on)
      .app-check-your-answers__contents
        %dt.app-check-your-answers__question= t('jobs.expires_on')
        %dd.app-check-your-answers__answer= format_date(@vacancy.expires_on)
      - if @vacancy.main_subject.present?
        .app-check-your-answers__contents
          %dt.app-check-your-answers__question= t('jobs.main_subject')
          %dd.app-check-your-answers__answer= @vacancy.main_subject

      - if @vacancy.other_subjects.present?
        .app-check-your-answers__contents
          %dt.app-check-your-answers__question= t('jobs.other_subjects')
          %dd.app-check-your-answers__answer= @vacancy.other_subjects

      - if @vacancy.pay_scale_range.present?
        .app-check-your-answers__contents
          %dt.app-check-your-answers__question= t('jobs.pay_scale_range')
          %dd.app-check-your-answers__answer= @vacancy.pay_scale_range
      - if @vacancy.leadership.present?
        .app-check-your-answers__contents
          %dt.app-check-your-answers__question= t('jobs.leadership_level')
          %dd.app-check-your-answers__answer= @vacancy.leadership.title
      - if @vacancy.contact_email.present?
        .app-check-your-answers__contents
          %dt.app-check-your-answers__question= t('jobs.contact_email')
          %dd.app-check-your-answers__answer.wordwrap= mail_to @vacancy.contact_email, @vacancy.contact_email, class: 'govuk-link', subject: t('jobs.contact_email_subject', job: @vacancy.job_title), body: t('jobs.contact_email_body', url: url_for(only_path: false))

    %h2.govuk-heading-m= t('jobs.description')
    %p= @vacancy.job_description

    - if !@vacancy.show_supporting_documents? && @vacancy.any_candidate_specification?
      - if @vacancy.education?
        %h2.govuk-heading-m= t('jobs.education')
        %p= @vacancy.education

      - if @vacancy.qualifications?
        %h2.govuk-heading-m= t('jobs.qualifications')
        %p= @vacancy.qualifications

      - if @vacancy.experience?
        %h2.govuk-heading-m= t('jobs.experience')
        %p= @vacancy.experience

    - if @vacancy.benefits?
      %h2.govuk-heading-m= t('jobs.benefits')
      %p= @vacancy.benefits

    - if @vacancy.show_supporting_documents?
      %h4.govuk-heading-m= t('jobs.supporting_documents')
      .supporting-docs
        %ul
          - @vacancy.documents.each do |document|
            %li
              %a.document-link{ href: document[:download_url], target: '_blank' }
                %svg{xmlns:"http://www.w3.org/2000/svg", width:"12", height:"18", viewBox:"0 0 16 22", fill:"none"}
                  %path{d:"M2 0C1.46957 0 0.960859 0.210714 0.585786 0.585786C0.210714 0.960859 0 1.46957 0 2V18C0 18.5304 0.210714 19.0391 0.585786 19.4142C0.960859 19.7893 1.46957 20 2 20H14C14.5304 20 15.0391 19.7893 15.4142 19.4142C15.7893 19.0391 16 18.5304 16 18V6L10 0H2ZM10 7H9V2L14 7H10Z", fill:"#0b0c0c"}
                  %image{src: asset_pack_path("media/images/icon-document.png")}
              %a.govuk-link.document-link{ href: document[:download_url], target: '_blank' } #{document[:name]}
              &nbsp#{number_with_precision(document[:size] / 1024.0 / 1024.0, precision: 2)} MB

    %h2.govuk-heading-m.share-this-job
      = t('jobs.share_this_job')
    = render partial: '/shared/vacancy/share_buttons'

    
    - if (@vacancy.application_link.present? && params[:apply_button] != 'top')
      %aside.vacancy--metadata
        = link_to t('jobs.apply'), new_job_interest_path(@vacancy.id), target: '_blank', class: 'govuk-button vacancy-apply-link', 'aria-label': t('jobs.aria_labels.apply_link')
