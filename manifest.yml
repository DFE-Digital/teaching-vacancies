---
applications:
  - name: teaching-vacancies-production
    buildpacks:
      - https://github.com/cloudfoundry/ruby-buildpack.git#v1.8.17
    env:
      RAILS_ENV: production
    processes:
      - type: web
        command: bundle exec rake cf:on_first_instance db:migrate && rails s
        instances: 4
        memory: 512M
      - type: worker
        command: bundle exec sidekiq -C config/sidekiq.yml
        health-check-type: process
        instances: 2
        memory: 1G
    services:
      - teaching-vacancies-postgres-production
      - teaching-vacancies-redis-production
      - teaching-vacancies-elasticsearch-production
      - teaching-vacancies-papertrail-production
